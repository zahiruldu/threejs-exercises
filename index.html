<!DOCTYPE html>
<html>

<head>
  <meta charset=utf-8>
  <title>My first three.js app</title>
  <style>
    body {
      margin: 0;
    }

    canvas {
      width: 100%;
      height: 100%
    }
  </style>
</head>

<body>
  <div id="container"></div>

  <script type="module">

    import * as THREE from '/js/build/three.module.js';

      import Stats from '/js/examples/jsm/libs/stats.module.js';

      import { OrbitControls } from '/js/examples/jsm/controls/OrbitControls.js';
      import { GLTFLoader } from '/js/examples/jsm/loaders/GLTFLoader.js';
      import { RGBELoader } from '/js/examples/jsm/loaders/RGBELoader.js';
      import { EquirectangularToCubeGenerator } from '/js/examples/jsm/loaders/EquirectangularToCubeGenerator.js';
      import { PMREMGenerator } from '/js/examples/jsm/pmrem/PMREMGenerator.js';
      import { PMREMCubeUVPacker } from '/js/examples/jsm/pmrem/PMREMCubeUVPacker.js';
      import { DRACOLoader } from '/js/examples/jsm/loaders/DRACOLoader.js';

      var container, stats, controls;
      var camera, scene, renderer;

      init();
      animate();

      function init() {

        container = document.createElement( 'div' );
        document.body.appendChild( container );

        camera = new THREE.PerspectiveCamera( 35, window.innerWidth / window.innerHeight, 1, 10000 );
        // camera.position.set(1.8, 0.9, 3000 );
        camera.position.z = 3500;

        scene = new THREE.Scene();
        // scene.background = new THREE.Color( 0xff0000 );

        var light = new THREE.AmbientLight( 0x404040 );
        light.position.set( 1, 1, 1 );
        scene.add( light );
        var group = new THREE.Group();

        // Loading gltf models

        // loadGltf('burtonjames_536sofa',function(gltf){
        //   gltf.scene.position.set(100,-200,100);
        //   scene.add( gltf.scene );
        // });

        loadGltf('burtonjames_536sofa_bottom',function(gltf){
          gltf.scene.position.set(0,-70,0);
          group.add( gltf.scene );
        });

        loadGltf('burtonjames_536sofa_cushion',function(gltf){
          gltf.scene.position.set(0,0,0);
          group.add( gltf.scene );
        });

        loadGltf('burtonjames_536sofa_cushionback',function(gltf){
          gltf.scene.position.set(0,0,-380);
          group.add( gltf.scene );
        });

        loadGltf('burtonjames_536sofa_leg1',function(gltf){
          gltf.scene.position.set(1150,0,0);
          group.add( gltf.scene );
        });

        loadGltf('burtonjames_536sofa_leg2',function(gltf){
          gltf.scene.position.set(-1150,0,0);
          group.add( gltf.scene );
        });

        group.position.set(0,-1000,0)
        scene.add(group)




        renderer = new THREE.WebGLRenderer( { antialias: true,alpha: true } );
        renderer.setPixelRatio( window.devicePixelRatio );
        renderer.setSize( window.innerWidth, window.innerHeight );
        renderer.gammaOutput = true;
        container.appendChild( renderer.domElement );

        controls = new OrbitControls( camera, renderer.domElement );
        controls.target.set( 0, - 0.2, - 0.2 );
        controls.update();

        window.addEventListener( 'resize', onWindowResize, false );

        // stats
        stats = new Stats();
        container.appendChild( stats.dom );

      }

      function loadGltf(model,callback) {
        DRACOLoader.setDecoderPath( 'js/examples/js/libs/draco/gltf/' );

        var loader = new GLTFLoader();

        loader.setPath( `VR/gltf/sofa/${model}/` );
        loader.setDRACOLoader( new DRACOLoader());

        loader.load( `${model}.gltf`, function ( gltf ) {
          callback(gltf);
        } );
      }


      function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

      }

      //

      function animate() {

        requestAnimationFrame( animate );
        renderer.render( scene, camera );

        stats.update();

      }

    </script>
</body>

</html>